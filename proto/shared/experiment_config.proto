syntax = "proto3";

option csharp_namespace = "LoRa";

message ForwardExperimentCommand {
    enum SlaveCommand {
        ClearFlash = 0;
        QueryFlash = 1;
        StreamFlashContents = 2; 
    }

    // Only valid if receiving slave
    optional SlaveCommand slaveCommand = 2;
}

message ExperimentResponse {
    uint32 MeasurementCount = 1;
    bool MeasurementsDisabled = 2;
    bool WasCleared = 3;
}

message MeasurementStreamRequest {
    uint32 FragmentSizeMax = 1;
}

message MeasurementStreamFragment {
    // Payload in generic bytes field
}

message DecodingResult {
    bool Success = 1;
    uint32 MatrixRank = 2;

    // We check the internal payload
    uint32 FirstDecodedNumber = 3;
    uint32 LastDecodedNumber = 4;
}

message DecodingUpdate {
    uint32 MatrixCrc8 = 1;
    uint32 FirstRowCrc8 = 2;
    uint32 SecondRowCrc8 = 3;
    uint32 Rank = 4;
    uint32 ReceivedFragments = 5;
    uint32 CurrentGenerationIndex = 6;
    bool IsRunning = 7;
    uint32 SeedState = 8;
}
